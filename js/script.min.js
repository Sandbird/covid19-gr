let gData,gRegions=[],gThresholds={carriers:0,deaths:0};const LANG=$("html").attr("lang"),RANDOMSTRING=Math.random().toString(36).substring(7),SCROLLBAR_WIDTH=window.innerWidth-$(window).width(),COLORS={default:"#3DC",men:"#5987A5",women:"#FEA",second:"#FEA",athensopen:"#5987A5",thessopen:"#3BA9B0",deaths:"#FB8",serious:"#FEA",infected_distribution:"#6F6587,#5987A5,#3BA9B0,#48C7A6,#86E18D,#D5F474".split(","),infected_distribution_men:"#48C7A6,#3BA9B0,#5987A5,#6F6587".split(","),predicted_deaths:"#3DC,#5987A5,#3BA9B0,#48C7A6,#86E18D,#D5F474".split(","),pcrtests:"#3DC,#5987A5,#3BA9B0,#48C7A6,#86E18D,#D5F474".split(","),icu_entry_exit:"#cf8490,#88BBAA".split(","),vaccinations:"#48C7A6,#3BA9B0,#6F6587".split(","),measures:"#90CFB5,#8FBDE0,#689AAB,#AADCD2,#3DC,#88BBAA,#BADDAD,#BBCDB3,#FAF28C,#DFEA8B,#F3EF89,#3BA9B0,#F4F4B2,#CCAC8E,#FBDEDE,#F8B2BC,#F59598,#EFA796,#FEBD7D,#CEB4D6,#B5B3DA,#88BBAA".split(","),measures2:"#3DC,#FEA,#5987A5,#3BA9B0,#86E18D,#D5F474,#FB8,#EC2,#CAF0F8".split(","),dark:"#399",selected:"#EC2",positivity_rate:["rgba(61, 207, 255)","rgba(89, 135, 165)"]},LABELS={gr:{change:"Τελευταία μεταβολή: ",total:"Σύνολο: ",daily_cases:"Ημερ. Κρ.: ",male:"Ανδ.",female:"Γυν.",months_pref:{Jan:"Ιαν",Feb:"Φεβρ",Mar:"Μαρτ",Apr:"Απρ",May:"Μαι",Jun:"Ιουν",Jul:"Ιουλ",Aug:"Αυγ",Sep:"Σεπτ",Oct:"Οκτ",Nov:"Νοε",Dec:"Δεκ"},months:["Ιανουαρίου","Φεβρουαρίου","Μαρτίου","Απριλίου","Μαΐου","Ιουνίου","Ιουλίου","Αυγούστου","Σεπτεμβρίου","Οκτωβρίου","Νοεμβρίου","Δεκεμβρίου"],transition:{carriers:["Κρούσματα"],active:["Ενεργά κρούσματα"],infected_distribution:["Υπό διερ.η ή άγν. προέλευσης","Σχετιζ. με ήδη γνωστό κρούσμα","Σχετιζ. με ταξίδι εξωτερικού"],infected_distribution_men:["0-17","18-39","40-64","65+"],death_distribution_men:["0-17","18-39","40-64","65+"],intensive_distribution_men:["0-17","18-39","40-64","65+"],infected_distribution_total:["0-17","18-39","40-64","65+"],death_distribution_total:["0-17","18-39","40-64","65+"],intensive_distribution_total:["0-17","18-39","40-64","65+"],infected_distribution_women:["0-17","18-39","40-64","65+"],death_distribution_women:["0-17","18-39","40-64","65+"],intensive_distribution_women:["0-17","18-39","40-64","65+"],predicted_deaths:["χαμηλότερο εύρος","πρόβλεψη","ανώτερο εύρος"],predicted_true_inf:["Ημερ. ενημέρωση","Πραγμ. αριθμ."],serious:["Κρίσιμη κατάσταση"],deaths:["Θάνατοι"],icu_percentages:["ΜΕΘ CoViD","Κλινών CoViD"],icu_entry_exit:["Εισαγωγές ασθενών","Εξιτήρια λόγω ίασης"],tests:["Δείγματα που ελέγχθ.","Βρέθηκαν θετικοί"],agtests:["Rapid Ag"],vaccinations:["Σύν. ολοκληρωμένων εμβ.","Σύν. με τουλάχιστον 1 δόση","Σύνολο εμβολιασμών"],rt_repro:["Βασικός αναπαραγωγικός αριθμός"],rj_repro:["Αναπαραγωγικός αριθμός"],infection_fatality_rate:["IIFR"],positivity_rate:["Μόνο με PCR"],positivity_rate_combined:["PCR+Rapid"],positivity_rate_daily:["Ημερ. τιμή (PCR+Rapid)"]},unit:{carriers:"",active:"",infected_distribution:"",infected_distribution_men:"",death_distribution_men:"",intensive_distribution_men:"",infected_distribution_total:"",death_distribution_total:"",intensive_distribution_total:"",infected_distribution_women:"",death_distribution_women:"",intensive_distribution_women:"",predicted_deaths:"",predicted_true_inf:"",serious:"",deaths:"",icu_percentages:["%"],icu_entry_exit:"",tests:"",agtests:"",vaccinations:"",rt_repro:"",rj_repro:"",infection_fatality_rate:["%"],positivity_rate:["%"]},demography:{sum:"Σύνολο",men:"Άνδρες",women:"Γυναίκες",cases:"Κρούσμ.",deaths:"Θάνατοι",serious:"Διασ."},prefectures:{increasing:"αυξητική",decreasing:"καθοδική",flat:"επίπεδη",less25:"Ετοιμότητας",less50:"Επιτήρησης",less150:"Επιτήρησης",less500:"Αυξημένου Κινδύνου",over500:"Πολύ Αυξημένου Κινδύνου",grey:"Δεν υπάρχουν δεδομένα",lightgrey:"Δεν υπάρχουν δεδομένα",danger:"Επίπεδο Επικινδυνότητας",latest_cases:"Τελευταίες 14 μέρες (νέα κρούσματα)",new_unemployed:"Νέες αιτήσεις ανέργων",total_unemployed:"Σύνολο ανέργων"},age:["65+","40-64","18-39","0-17"],age2:["65","40_64","18_39","0_17"]},en:{change:"Daily: ",total:"Total: ",daily_cases:"Daily Cases: ",male:"Male",female:"Fem.",months_pref:{Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",May:"May",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec"},months:["January","February","March","April","May","June","July","August","September","October","November","December"],transition:{carriers:["Tested Positive"],active:["Active Cases"],infected_distribution:["Still under investigation or of unknown origin","Related to an already known case","Related to travel from abroad"],infected_distribution_men:["0-17","18-39","40-64","65+"],death_distribution_men:["0-17","18-39","40-64","65+"],intensive_distribution_men:["0-17","18-39","40-64","65+"],infected_distribution_total:["0-17","18-39","40-64","65+"],death_distribution_total:["0-17","18-39","40-64","65+"],intensive_distribution_total:["0-17","18-39","40-64","65+"],infected_distribution_women:["0-17","18-39","40-64","65+"],death_distribution_women:["0-17","18-39","40-64","65+"],intensive_distribution_women:["0-17","18-39","40-64","65+"],demography_total2:["","",""],predicted_deaths:["lower range","projected","upper range"],predicted_true_inf:["Daily report","Spec. of newly infected"],serious:["Serious"],deaths:["Deaths"],icu_percentages:["ICU Beds coverage","Non-ICU Beds coverage"],icu_entry_exit:["Admissions","Discharges"],tests:["Tested","Found Positive"],agtests:["Rapid Ag"],vaccinations:["Completed vaccinations","With at least 1 dose","Total vaccinations given"],rj_repro:["Reproduction Number"],rt_repro:["Effective Reproduction Number"],infection_fatality_rate:["IIFR"],positivity_rate:["Using only PCR"],positivity_rate_combined:["PCR+Rapid"],positivity_rate_daily:["Daily PCR+Rapid"]},unit:{carriers:"",active:"",demography_total2:"",infected_distribution:"",infected_distribution_men:"",death_distribution_men:"",intensive_distribution_men:"",infected_distribution_total:"",death_distribution_total:"",intensive_distribution_total:"",infected_distribution_women:"",death_distribution_women:"",intensive_distribution_women:"",predicted_deaths:"",predicted_true_inf:"",serious:"",deaths:"",icu_percentages:["%"],icu_entry_exit:"",tests:"",agtests:"",vaccinations:"",rt_repro:"",rj_repro:"",infection_fatality_rate:["%"],positivity_rate:["%"]},demography:{sum:"Sum",men:"Men",women:"Women",cases:"Cases",deaths:"Deaths",serious:"Serious"},prefectures:{increasing:"increasing",decreasing:"decreasing",flat:"flat",less25:"Readiness",less50:"Surveillance",less150:"Surveillance",less500:"Increased Risk",over500:"Very High Risk",grey:"Alert",lightgrey:"No available data",danger:"Risk Level",latest_cases:"Last 14 days (new cases)",new_unemployed:"New unemployment claims",total_unemployed:"Total Unemployed"},age:["65+","40-64","18-39","0-17"],age2:["65","40_64","18_39","0_17"]}},init=()=>{const t=t=>String(t).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),e=()=>{$(".transition.nationwide").each(function(){o($(this),$(this).attr("code"),$(this).attr("pref"),!0),r($(this))})},a=()=>{$(".transition").each(function(){$(this).find(".axis-chart").css("height","calc(100% - "+SCROLLBAR_WIDTH+"px)"),$(this).find(".axis-cover").css("height","calc(100% - "+SCROLLBAR_WIDTH+"px)")})},i=t=>{var e=t.find(".embed"),a="520px",i="448px";switch(t.attr("code")){case"prefectures-box":a="100%";break;case"icu_percentages":case"demography_sum":case"demography_men":case"demography_men":i="327px";break;case"icu_entry_exit":i="440px";break;case"demography_group_cases":case"demography_group_deaths":case"demography_group_intensive":i="500px";break;case"rj_repro":case"positivity_rate":case"infection_fatality_rate":case"predicted_deaths":i="357px";break;case"predicted_true_inf":i="405px";break;case"unemployment":a="100%",i="395px";break;case"map-box":i="535px"}var o='<iframe src="https://covid19-greece.tk/embed/?by=code&tag='+t.attr("code")+"&lang="+LANG+'" loading="lazy" style="width: '+a+"; height: "+i+'; border: 0px none;"></iframe>';e.val(o)},o=(e,a,o,r=!1)=>{const s=(t,e,a,i,o)=>{let r=COLORS.default,s=n(a,i,!0);if(""===e&&"carriers"===t&&(s<20200328&&(r=COLORS.measures[o]),s>=20200328&&(r=COLORS.measures[o+1]),s>=20200601&&(r=COLORS.measures[o+3]),s>=20200615&&(r=COLORS.measures[o+5]),s>=20200701&&(r=COLORS.measures[o+7]),s>=20200715&&(r=COLORS.measures[o+9]),s>=20200720&&(r=COLORS.measures[o+2]),s>=20200815&&(r=COLORS.measures[o+6]),s>=20200914&&(r=COLORS.measures[o+21]),s>=20201107&&(r=COLORS.measures[o+11]),s>=20210514&&(r=COLORS.default)),"3"===e&&("carriers"!==t&&"deaths"!==t||s>=20200615&&(r=COLORS.athensopen)),"1"===e&&("carriers"!==t&&"deaths"!==t||s>=20200601&&(r=COLORS.athensopen)),""===e&&"infected_distribution"===t&&(r=COLORS.infected_distribution[o]),""!==e||"infected_distribution_men"!==t&&"death_distribution_men"!==t&&"intensive_distribution_men"!==t&&"infected_distribution_total"!==t&&"death_distribution_total"!==t&&"intensive_distribution_total"!==t&&"infected_distribution_women"!==t&&"death_distribution_women"!==t&&"intensive_distribution_women"!==t||(r=COLORS.infected_distribution_men[o]),""===e&&"tests"===t&&(r=COLORS.pcrtests[o]),""===e&&"predicted_true_inf"===t&&(r=COLORS.pcrtests[o]),""===e&&"icu_entry_exit"===t&&(r=COLORS.icu_entry_exit[o]),""===e&&"predicted_deaths"===t&&(r=COLORS.predicted_deaths[o]),""===e&&"agtests"===t&&(r=COLORS.pcrtests[o]),"vaccinations"===t&&(r=COLORS.vaccinations[o]),"rt_repro"===t){const t=new Date;r=s<=[t.getFullYear(),`${t.getMonth()+1}`.padStart(2,"0"),`${t.getDate()}`.padStart(2,"0")].join("")?COLORS.default:"#242A3C"}return r},n=(t,e,a)=>{let i=new Date(t[0],t[1]-1,t[2]);i.setDate(i.getDate()+e);let o="",r=i.getFullYear(),s=i.getMonth()+1,n=i.getDate();if(a){o=1e4*parseInt(r)+100*parseInt(s)+parseInt(n)}else"gr"===LANG&&(o=s+"/"+n),"en"===LANG&&(o=s+"/"+n);return o};function d(t,e){var a=Math.pow(10,e);return Math.round(t*a)/a}let l=e.find(".main-chart").empty().html("<canvas></canvas>"),c=l.find("canvas")[0],p=e.find(".switch.selected").attr("value"),u=!!e.find(".checkbox.moving-average").hasClass("on"),g=gData.transition[a];if(""!==o&&(g=gData["prefectures-data"][parseInt(o)-1][a]),void 0!==g){let m=g.from,b=g.values;((e,a)=>{let i=0,o=0,r=0,s=0,n=0,l=0;for(let t=0;t<a.length;t++)for(let e=0;e<a[0].length;e++)i+=a[t][e],t===a.length-1&&(o+=a[t][e]);if("tests"===e.attr("code")){var c=a.reduce(function(t,e){return e.forEach(function(e,a){t[a]=(t[a]||0)+e}),t},[]);let t=a[a.length-1];i=d(c[0],1),o-=t[1]}if("predicted_true_inf"===e.attr("code")||"predicted_deaths"===e.attr("code")){c=a.reduce(function(t,e){return e.forEach(function(e,a){t[a]=(t[a]||0)+e}),t},[]);let t=a[a.length-1];i=d(c[1],1),o-=t[1]}"rj_repro"!==e.attr("code")&&"rt_repro"!==e.attr("code")&&"infection_fatality_rate"!==e.attr("code")||(i=Math.round(1e3*a[a.length-1][0])/1e3,o=Math.round(1e3*(a[a.length-1][0]-a[a.length-2][0]))/1e3),"positivity_rate"===e.attr("code")&&(i=Math.round(1e3*a[a.length-1][0])/1e3,o=Math.round(1e3*(a[a.length-1][0]-a[a.length-2][0]))/1e3,r=Math.round(1e3*gData.transition.positivity_rate_combined.values[gData.transition.positivity_rate_combined.values.length-1][0])/1e3,s=Math.round(1e3*(gData.transition.positivity_rate_combined.values[gData.transition.positivity_rate_combined.values.length-1][0]-gData.transition.positivity_rate_combined.values[gData.transition.positivity_rate_combined.values.length-2][0]))/1e3,n=Math.round(1e3*gData.transition.positivity_rate_daily.values[gData.transition.positivity_rate_daily.values.length-1][0])/1e3,l=Math.round(1e3*(gData.transition.positivity_rate_daily.values[gData.transition.positivity_rate_daily.values.length-1][0]-gData.transition.positivity_rate_daily.values[gData.transition.positivity_rate_daily.values.length-2][0]))/1e3);var p="";if("active"===e.attr("code")&&(p="~"),i=t(i),"-"!==(o=t(o)).charAt(0)&&(o="+"+o),"icu_entry_exit"===e.attr("code")){var u=0,g=0;for(let t=0;t<a.length;t++)u+=a[t][0],g+=a[t][1];u=t(u),g=t(g),"-"!==u.charAt(0)&&(u="+"+u),"-"!==g.charAt(0)&&(g="+"+g);let o=e.find(".latest");o.find(".value").text(p+i),o.find(".unit").text(LABELS[LANG].unit[e.attr("code")]),o.find(".type").text(LABELS[LANG].total),o.find("#admissions").text(LABELS[LANG].transition.icu_entry_exit[0]+": "+u),o.find("#discharged").text(LABELS[LANG].transition.icu_entry_exit[1]+": "+g)}else if("vaccinations"===e.attr("code")){var h=0,f=0,m=0;for(let t=0;t<a.length;t++)h=a[t][0],f=a[t][1],m=a[t][2];f=t(f),m=t(m),h=t(h),"-"!==f.charAt(0)&&(f="+"+f),"-"!==m.charAt(0)&&(m="+"+m),"-"!==h.charAt(0)&&(h="+"+h);let o=e.find(".latest");o.find(".value").text(p+i),o.find(".unit").text(LABELS[LANG].unit[e.attr("code")]),o.find(".type").text(LABELS[LANG].total),o.find(".total_vaccinations").text(LABELS[LANG].transition.vaccinations[0]+": "+h),o.find(".totaldose1").text(LABELS[LANG].transition.vaccinations[1]+": "+f),o.find(".vaccompleted").text(LABELS[LANG].transition.vaccinations[2]+": "+m)}else if("positivity_rate"===e.attr("code")){var b=e.find("#pos_pcr"),_="<span class='unit'>"+LABELS[LANG].unit[e.attr("code")]+"</span>";b.find(".valuesmall").html(p+i+_),b.find(".type").text(LABELS[LANG].transition.positivity_rate+": ").css("color","#EC2"),b.find(".change").text("("+o+")").css("font-size","10px"),r=t(r),s=t(s),l=t(l),"-"!==s.charAt(0)&&(s="+"+s),"-"!==l.charAt(0)&&(l="+"+l),b=e.find("#pos_combined"),_="<span class='unit'>"+LABELS[LANG].unit[e.attr("code")]+"</span>",b.find(".valuesmall").html(p+r+_),b.find(".type").text(LABELS[LANG].transition.positivity_rate_combined+": ").css("color",COLORS.positivity_rate[0]),b.find(".change").text("("+s+")").css("font-size","10px"),b=e.find("#pos_daily"),_="<span class='unit'>"+LABELS[LANG].unit[e.attr("code")]+"</span>",b.find(".valuesmall").html(p+n+_),b.find(".type").text(LABELS[LANG].transition.positivity_rate_daily+": ").css("color","#ace"),b.find(".change").text("("+l+")").css("font-size","10px")}else{let t=e.find(".latest");t.find(".value").text(p+i),t.find(".unit").text(LABELS[LANG].unit[e.attr("code")]),t.find(".type").text(LABELS[LANG].total),t.find(".change").text(LABELS[LANG].change+o)}})(e,b);var h=!0;"rt_repro"!=a&&"infection_fatality_rate"!=a&&"positivity_rate"!=a&&"vaccinations"!=a||(h=!1);let _={type:"bar",data:{labels:[],datasets:[]},options:{maintainAspectRatio:!1,animation:{duration:r?1e3:0},legend:{display:!1},title:{display:!1},tooltips:{xPadding:24,yPadding:12,displayColors:!1,callbacks:{title:function(t){let a=t[0].xLabel.trim();return"gr"===LANG&&(a="Στις "+a),"en"===LANG&&(a="As of "+a),a+" "+e.find(".switch.selected").text()},label:function(e,i){let o=[],r=0;i.datasets.forEach(function(i,s){if("reproduction_rj_infected"==a){if(root_rj=gData.transition.reproduction_rj.values,!u||s>=1){var n=void 0!==root_rj[e.index]?root_rj[e.index]:"n/a";o.push(i.label+": "+t(i.data[e.index])+" | "+LABELS[LANG].unit[a]+LABELS[LANG].transition.reproduction_rj+": "+n),r+=i.data[e.index]}}else if("predicted_deaths"==a){root_pd=gData.transition.predicted_deaths.values;var d=root_pd[e.index];if(0==d[0]&&0==d[2])"πρόβλεψη"!=i.label&&"projected"!=i.label||o.push(LABELS[LANG].transition.deaths+": "+t(i.data[e.index]));else{if("πρόβλεψη"==i.label||"projected"==i.label)var l=parseFloat(t(i.data[e.index])).toFixed(2);else l=t(i.data[e.index]);o.push(i.label+": "+l+" "+LABELS[LANG].unit[a])}}else"infection_fatality_rate"==a||"positivity_rate"==a?(o.push(i.label+": "+t(i.data[e.index])+LABELS[LANG].unit[a]),r+=i.data[e.index]):(!u||s>=1)&&(o.push(i.label+": "+t(i.data[e.index])+" "+LABELS[LANG].unit[a]),r+=i.data[e.index])}),o.reverse();let s=u?3:2;return"predicted_deaths"==!a&&i.datasets.length>=s&&o.push(LABELS[LANG].total+": "+t(r)+" "+LABELS[LANG].unit[a]),o}}},scales:{xAxes:[{stacked:!0,gridLines:{display:!1,zeroLineColor:"rgba(255,255,0,0.7)"},ticks:{fontColor:"rgba(255,255,255,0.7)",maxRotation:0,minRotation:0,callback:t=>" "+t+" "}}],yAxes:[{location:"bottom",stacked:!0,gridLines:{display:!0,zeroLineColor:"rgba(255,255,255,0.7)",borderDash:[3,1],color:"rgba(255, 255, 255, 0.3)"},ticks:{beginAtZero:h,fontColor:"transparent"}}]},layout:{padding:{left:10}}}};"predicted_true_inf"==a&&(_.options.scales.xAxes=[{stacked:!0,gridLines:{drawOnChartArea:!1,tickMarkLength:10,color:"rgba(255, 255, 255, 0.3)"},ticks:{autoSkip:!0,fontColor:"rgba(255,255,255,0.7)",maxRotation:0,minRotation:0,callback:t=>" "+t+" "}}],_.options.scales.yAxes=[{stacked:!1,gridLines:{display:!0,zeroLineColor:"rgba(255,255,255,0.7)",borderDash:[3,1],color:"rgba(255, 255, 255, 0.3)"},ticks:{fontColor:"transparent",userCallback:function(t,e,a){return t=(t=(t=t.toString()).split(/(?=(?:...)*$)/)).join(",")}}}]),"infected_distribution"!=a&&"infected_distribution_men"!=a&&"death_distribution_men"!=a&&"intensive_distribution_men"!=a&&"infected_distribution_total"!==a&&"death_distribution_total"!==a&&"intensive_distribution_total"!==a&&"infected_distribution_women"!==a&&"death_distribution_women"!==a&&"intensive_distribution_women"!==a||(_.options.tooltips.caretSize=0,_.options.tooltips.titleFontSize=12,_.options.tooltips.bodyFontSize=11,_.options.tooltips.bodySpacing=0,_.options.tooltips.titleSpacing=0,_.options.tooltips.xPadding=10,_.options.tooltips.yPadding=10,_.options.tooltips.cornerRadius=2,_.options.tooltips.titleMarginBottom=2);for(let t=0;t<b[0].length;t++){if(_.data.datasets.push({label:LABELS[LANG].transition[a][t],backgroundColor:[],data:[]}),"rj_repro"===a||"rt_repro"===a||"infection_fatality_rate"===a||"positivity_rate"===a){let t=_.data.datasets[_.data.datasets.length-1];t.type="line",t.fill=!1,t.pointRadius=2,t.pointBorderColor="#EC2",t.borderColor="#EC2"}if("predicted_deaths"===a){let t=_.data.datasets[_.data.datasets.length-1];"πρόβλεψη"!=t.label&&"projected"!=t.label||(t.type="line",t.fill=!1,t.pointRadius=2,t.pointBorderColor="#EC2",t.borderColor="#EC2")}}let v="",y=[];for(let t=0;t<b[0].length;t++)y.push(0);if(b.forEach(function(t,e){let i=s(a,o,m,e,0);_.data.labels.push(n(m,e,!1));for(let i=0;i<b[0].length;i++){y[i]+=t[i];let r=t[i];""===t[i]&&(r=0),r<0&&("total"===p||"active"===a||"carriers"===a||"infected_distribution"===a||"infected_distribution_men"===a||"death_distribution_men"===a||"predicted_deaths"===a||"deaths"===a||"tests"===a||"agtests"===a||"vaccinations"===a)&&(r=0),"total"===p&&(r=y[i]),"total"===p&&r<0&&"active"===a&&(r=0),_.data.datasets[i].data.push(r),_.data.datasets[i].backgroundColor.push(s(a,o,m,e,i))}v=i}),l.width(Math.max(8*_.data.labels.length,l.width())),u){let t=7,e={type:"line",label:LABELS[LANG].movingAverage,fill:!1,borderColor:"#FBA",borderWidth:3,pointRadius:0,data:[]};for(let a=0;a<_.data.datasets[0].data.length;a++){let i=null;if(a>=t){i=0;for(let e=0;e<t;e++)_.data.datasets.forEach(function(t,o){i+=parseInt(t.data[a-e])});i/=t}e.data.push(i)}_.data.datasets.unshift(e)}var f=!0;if("predicted_true_inf"==a||"positivity_rate"==a||"icu_entry_exit"==a||"vaccinations"==a)f=!1;if("positivity_rate"==a){["positivity_rate_combined","positivity_rate_daily"].forEach(function(t,e){var a="positivity_rate_combined"==t?"line":"bar",i="positivity_rate_combined"==t?COLORS.positivity_rate[0].replace(/rgba?(\(\s*\d+\s*,\s*\d+\s*,\s*\d+)(?:\s*,.+?)?\)/,"rgba$1,1)"):COLORS.positivity_rate[1].replace(/rgba?(\(\s*\d+\s*,\s*\d+\s*,\s*\d+)(?:\s*,.+?)?\)/,"rgba$1,0.5)"),o={type:a,label:LABELS[LANG].transition[t],fill:!1,pointBorderColor:COLORS.positivity_rate[e],borderColor:COLORS.positivity_rate[e],backgroundColor:i,pointRadius:2,data:[]};gData.transition[t].values.forEach(function(t,e){o.data.push(t[0])}),_.options.scales.xAxes=[{stacked:!1,gridLines:{display:!1,zeroLineColor:"rgba(255,255,0,0.7)"},ticks:{fontColor:"rgba(255,255,255,0.7)",maxRotation:0,minRotation:0,callback:t=>" "+t+" "}}],_.options.scales.yAxes=[{location:"bottom",stacked:!1,gridLines:{display:!0,zeroLineColor:"rgba(255,255,255,0.7)",borderDash:[3,1],color:"rgba(255, 255, 255, 0.3)"}}],_.data.datasets.unshift(o)})}((t,e)=>{const a=t=>{let e=t.split("/");return e[1]+" "+LABELS[LANG].months[parseInt(e[0])-1]};let i=t.find("h5.updated");if(!i.hasClass("show")){let t=e.data.labels[e.data.labels.length-1],o={gr:"Στις "+a(t),en:"As of "+a(t)};i.text(o[LANG]),i.addClass("show")}})(e,_),i(e),((e,a,i)=>{let o=e.find(".axis-chart").empty().html("<canvas></canvas>").find("canvas")[0],r={type:"bar",data:a,options:{maintainAspectRatio:!1,legend:{display:!1},title:{display:!1},scales:{xAxes:[{stacked:i,drawBorder:!1,gridLines:{display:!1},ticks:{fontColor:"rgba(255,255,255,0.0)",maxRotation:0,minRotation:0}}],yAxes:[{id:"axisScale",location:"bottom",stacked:i,gridLines:{drawBorder:!1,display:!1},ticks:{beginAtZero:!0,fontColor:"rgba(255,255,255,0.7)",callback:function(e,a,i){if(Math.floor(e)===e)return t(e.toString())}}}]}}};r.data.datasets.forEach(function(t,e){t.backgroundColor="transparent",t.borderColor="transparent",t.pointBorderColor="transparent"}),r.data.labels.forEach(function(t,e){}),window.myChart=new Chart(o.getContext("2d"),r);let s=window.myChart.scales.axisScale.max,n=window.myChart.scales.axisScale.min,d=0;switch(Math.max(s.toString().length,n.toString().length)){case 1:d=36;break;case 2:d=40;break;case 3:d=48;break;case 4:d=54;break;case 5:d=66;break;case 6:d=72;break;case 7:d=78}e.find(".axis-cover").width(d.toString()+"px")})(e,$.extend(!0,{},_.data),f),window.myChart=new Chart(c.getContext("2d"),_)}},r=t=>{let e=t.find(".main-chart");t.find(".main-chart-wrapper").animate({scrollLeft:e.width()},0)},s=(t,e)=>{let a=0;return t.forEach(function(t,e){t.forEach(function(t,e){a+=t})}),a},n=function(t){var e=t.split("-");return LABELS[LANG].months_pref[e[0]]+"-"+e[1]||t},d=(t,e)=>{let a=new Date(t[0],t[1]-1,t[2]);var i=a.getDate();a.setMonth(a.getMonth()+e),a.getDate()!=i&&a.setDate(0);let o="",r=a.getFullYear().toString().substr(-2),s=a.getMonth();return"gr"===LANG&&(o=LABELS[LANG].months[s].substr(0,3)+"-"+r),"en"===LANG&&(o=LABELS[LANG].months[s].substr(0,3)+"-"+r),o},l=e=>{let a=$("#icu-chart").empty().html("<canvas></canvas>"),o=a.find("canvas")[0],r=$("#icu_percentages"),s={type:"horizontalBar",data:{labels:[],datasets:[{label:"",backgroundColor:["#c45850","#5987A5"],borderWidth:.5,borderColor:"#242a3c",data:[]}]},options:{aspectRatio:.9,responsive:!0,legend:{display:!1},title:{display:!1},tooltips:{xPadding:24,yPadding:12,displayColors:!0},scales:{xAxes:[{stacked:!1,position:"top",gridLines:{color:"rgba(255,255,255,0.2)",zeroLineColor:"rgba(255,255,255,0.2)",borderDash:[3,1]},ticks:{suggestedMin:0,fontColor:"rgba(255,255,255,0.7)",callback:function(e,a,i){return t(e)}}}],yAxes:[{stacked:!1,barPercentage:.5,gridLines:{color:"rgba(255,255,255,0.1)"},ticks:{fontColor:"rgba(255,255,255,0.7)"}}]},hover:{animationDuration:0},animation:{duration:1,onComplete:function(){var t=this.chart,e=t.ctx;e.font=Chart.helpers.fontString(Chart.defaults.global.defaultFontSize,Chart.defaults.global.defaultFontStyle,Chart.defaults.global.defaultFontFamily),e.fillStyle="white",e.textAlign="right",e.textBaseline="bottom",this.data.datasets.forEach(function(a,i){t.controller.getDatasetMeta(i).data.forEach(function(t,i){var o=a.data[i]+"%";e.fillText(o,t._model.x-10,t._model.y+7)})})}},plugins:{datalabels:{anchor:"end",align:"top",formatter:Math.round,font:{weight:"bold"}}}}};gData.transition.icu_percentages.values.forEach(function(t,e){for(let t=0;t<2;t++)s.data.labels.push(LABELS[LANG].transition.icu_percentages[t])}),gData.transition.icu_percentages.values[0].forEach(function(t,e){s.data.datasets[0].data.push(t)}),a.outerWidth()>=400&&(s.options.aspectRatio=2.1),a.outerWidth()>=600&&(s.options.aspectRatio=2.3);const n=t=>t[2]+" "+LABELS[LANG].months[parseInt(t[1])-1];let d=$("#icu_percentages").find("h5.updated");if(!d.hasClass("show")){let t=gData.transition.icu_percentages.from,e={gr:"Στις "+n(t),en:"As of "+n(t)};d.text(e[LANG]),d.addClass("show")}if(void 0!==o){let t=o.getContext("2d");window.myChart=new Chart(t,s)}i(r)},c=t=>{let e=$("#unemployment"),a=$("#unemployment-chart").empty().html("<canvas></canvas>"),o=a.find("canvas")[0],r=$("#select-unemp-type").val();void 0!==r||(r=1);var s={type:"bar",data:{labels:[],datasets:[{type:"line",label:LABELS[LANG].prefectures.new_unemployed,data:[],borderColor:"#0CBF12",backgroundColor:"rgba(0, 0, 0, 0)",yAxisID:"newunemployed"},{label:LABELS[LANG].prefectures.total_unemployed,data:[],borderColor:"rgba(0, 0, 0, 0)",backgroundColor:"#C5042D",yAxisID:"totalunemployed"}]},options:{maintainAspectRatio:!1,responsive:!0,legend:{display:!0,labels:{fontColor:"rgba(255, 255, 255, 0.7)"}},animation:{duration:1e3},scales:{xAxes:[{gridLines:{color:"rgba(255,255,255,0.2)",zeroLineColor:"rgba(255,255,255,0.2)",borderDash:[3,1]},ticks:{suggestedMin:0,fontColor:"rgba(255,255,255,0.7)"}}],yAxes:[{id:"totalunemployed",position:"left",ticks:{fontColor:"rgba(255,255,255,0.7)",beginAtZero:!0},gridLines:{display:!0,color:"rgba(255,255,255,0.2)",zeroLineColor:"rgba(255,255,255,0.2)",borderDash:[3,1]},scaleLabel:{display:!0,labelString:LABELS[LANG].prefectures.total_unemployed}},{id:"newunemployed",position:"right",ticks:{display:!0,fontColor:"rgba(255,255,255,0.7)",beginAtZero:!0},gridLines:{display:!1,color:"rgba(255,255,255,0.2)",zeroLineColor:"rgba(255,255,255,0.2)",borderDash:[3,1]},scaleLabel:{display:!1,labelString:LABELS[LANG].prefectures.new_unemployed}}]}}};let n=[];for(var l=gData["regions-unemployment"][0].new_claims.from,c=gData["regions-unemployment"][0].new_claims.values.length,p=0;p<c;p++)s.data.labels.push(d(l,p));if(gData["regions-unemployment"].forEach(function(t,e){t.code==r&&n.push({name:gData["regions-unemployment"][e][LANG],new_claims:t.new_claims,total_unemployed:t.total_unemployed,code:e.toString()})}),n.forEach(function(t,e){s.data.datasets[0].data=t.new_claims.values,s.data.datasets[1].data=t.total_unemployed.values}),a.outerWidth()>=400&&(s.options.aspectRatio=1.1),a.outerWidth()>=600&&(s.options.aspectRatio=1.3),void 0!==o){let t=o.getContext("2d");window.myChart=new Chart(t,s)}i(e)},p=()=>{$("#greece-map").empty();let t={navigation:{buttonOptions:{enabled:!1}},legend:{enabled:!1},credits:{enabled:!1},chart:{map:"countries/gr/gr-all"},title:{text:""},subtitle:{text:""},mapNavigation:{enabled:!1},tooltip:{formatter:function(){var t,e=this.point.value,a="";return gData["prefectures-data"].forEach(function(i,o){i.gr!==e[1]&&i.en!==e[1]||(t=i.value,a+='<span style="color:'+COLORS.selected+'">'+i[LANG]+"</span><br>"+LABELS[LANG].transition.carriers+" : "+t)}),a}},series:[{stickyTracking:!0,data:[["gr-at",[1,"Attica"]],["gr-gc",[2,"Central Greece"]],["gr-mc",[3,"Central Macedonia"]],["gr-cr",[4,"Crete"]],["gr-mt",[5,"Eastern Macedonia and Thrace"]],["gr-ep",[6,"Epirus"]],["gr-ii",[7,"Ionian Islands"]],["gr-ma",[8,"Mount Athos"]],["gr-an",[9,"North Aegean"]],["gr-pp",[10,"Peloponnese"]],["gr-as",[11,"South Aegean"]],["gr-ts",[12,"Thessaly"]],["gr-gw",[13,"Western Greece"]],["gr-mw",[14,"Western Macedonia"]]].map(t=>{var e,a=["#33ddcc","#48C7A6","#3BA9B0","#5987A5","#6F6587"];return gData["prefectures-data"].forEach(function(i,o){i.gr!==t[1][1]&&i.en!==t[1][1]||((e=i.value100k)>0&&e<=200?t.push(a[0]):e>200&&e<=400?t.push(a[1]):e>400&&e<=600?t.push(a[2]):e>600&&e<=800?t.push(a[3]):e>800&&t.push(a[4]))}),t}),keys:["hc-key","value","color"],name:"",borderColor:"black",borderWidth:.1,states:{hover:{color:"#eecc22"}},dataLabels:{enabled:!1,format:"{point.name}"},point:{events:{mouseOver:function(t){h(t.target.value[0]),f(t.target.value[0])}}}}]};0!=$("#greece-map").length&&Highcharts.mapChart("greece-map",t)},u=()=>{let t=$("#prefectures-box");gData["prefectures-details"].forEach(function(t,e){var a,i,o,r=gData["prefectures-details"][e][LANG],s=t.twoweektrendlatest,n=t.newcasesperweekpop,d=Math.floor(n),l=t.last14days_rolling.values,c=t.last14days_rolling_vax.values,p=t.color,u=LABELS[LANG].prefectures[t.color],g="",h=Array.isArray(t.rj_value)?t.rj_value[1].slice(-1).pop():"",f=t.newcases>0?"+"+parseInt(t.newcases).toLocaleString("en-GB",{minimumFractionDigits:0,maximumFractionDigits:2}):"",m=t.newvaccinations>0?"+"+parseInt(t.newvaccinations).toLocaleString("en-GB",{minimumFractionDigits:0,maximumFractionDigits:2}):"",b=parseInt(t.totalcases).toLocaleString("en-GB",{minimumFractionDigits:0,maximumFractionDigits:2}),_=parseInt(t.total_vaccinations).toLocaleString("en-GB",{minimumFractionDigits:0,maximumFractionDigits:2}),v=parseInt(t.population).toLocaleString("en-GB",{minimumFractionDigits:0,maximumFractionDigits:2}),y=t.firstdose_percentage+"%",L=t.seconddose_percentage+"%";if(n<=12)var A="#fff!important;";else A="inherit;";Array.isArray(t.rj_value)&&(t.rj_value[0][1]<t.rj_value[1][1]?(o="increasing",g=LABELS[LANG].prefectures.increasing):t.rj_value[0][1]>t.rj_value[1][1]?(o="decreasing",g=LABELS[LANG].prefectures.decreasing):(o="flat",g=LABELS[LANG].prefectures.flat)),s>=0&&s<=5?(a="flat",i=LABELS[LANG].prefectures.flat):s>5?(a="increasing",i=LABELS[LANG].prefectures.increasing):(a="decreasing",i=LABELS[LANG].prefectures.decreasing),$("#tbodyid").append(`<tr>\n\t\t\t\t<td id="box_${e}" class="${p} personPopupTrigger" style="text-align:left!important" rel="${r},${u},${p}">${r}</td>\n\t\t\t\t<td class="${a} smallertext"><h4 class="m-0 font-weight-bold" style="color: inherit;">${t.twoweektrendlatest}%</h4><span class="${a}">${i}</span></td>\n\t\t\t\t<td><span id="sparkline${e}"></span></td>\n\t\t\t\t<td><h4 class="m-0" style="color: inherit;">${b}</h4><div style="font-size: 10px; margin-top: -2px; color: #ffc108">${f}</div></td>\n\t\t\t\t<td><div class="progress"><div role="progressbar" aria-valuenow="${n}" aria-valuemin="0" aria-valuemax="200" class="progress-bar ${p}" style="width: ${d}%;color: ${A}">${n}</div></div></td>\n\t\t\t\t<td class="${o} smallertext"><h4 class="m-0 font-weight-bold" style="color: inherit;">${h}</h4><span>${g}</span></td>\n\t\t\t\t<td><h4 class="m-0" style="color: #3DC;">${_}</h4><div style="font-size: 10px; margin-top: -2px; color: #8bc34a">${m}</div></td>\n\t\t\t\t<td><span id="sparkline_vac${e}"></span></td>\n\t\t\t\t<td><h4 class="m-0" style="color: #3DC;">${y}</h4></td>\n\t\t\t\t<td><h4 class="m-0" style="color: #3DC;">${L}</h4></td>\n\t\t\t\t<td><h4 class="m-0" style="color: inherit;">${v}</h4></td>\t\t\t\t\t\n\t\t\t</tr>`),$("#sparkline"+e).sparkline(l,{type:"line",width:100,height:30,lineColor:"#0083CD",fillColor:"rgba(0,131,205,0.2)",minSpotColor:!0,maxSpotColor:!0}),$("#sparkline_vac"+e).sparkline(c,{type:"line",width:100,height:30,lineColor:"#0083CD",fillColor:"rgba(0,131,205,0.2)",minSpotColor:!0,maxSpotColor:!0})}),$("#search-nomous").on("keyup",function(){var t=$(this).val().toLowerCase();$("#tbodyid tr").filter(function(){$(this).toggle($(this).text().toLowerCase().indexOf(t)>-1)})}),$("#prefectures").tablesorter({theme:"blackice",widgets:["saveSort"],widgetOptions:{saveSort:!0},sortList:[[4,1]]}),$("#pref-updated").text(gData.updated.lastprefecture[LANG]),i(t),$.protip({observer:!0,defaults:{width:"310!",scheme:"blue",size:"small",gravity:!0,position:"bottom"}})},g=()=>{var t=null,e=function(){t&&clearTimeout(t),t=setTimeout(function(){a={left:"0px",top:"0px"},i.css("display","none")},500)},a={left:"0px",top:"0px"},i=$(`<div class="root" id="PopupContainer">\n\t\t\t   <div class="StateTooltip" style="width: 350px;">\n\t\t\t      <div style="margin-bottom: 9px; border-bottom: 1px solid rgb(238, 238, 238);">\n\t\t\t         <div class="Row">\n\t\t\t            <div class="Col" style="white-space: nowrap;">\n\t\t\t               <div style="font-weight: bold; padding: 0px 0px 5px;">\n\t\t\t                  <div class="ColorDot ColorDotFlashing colorclass" style=""></div>\n\t\t\t                  <span id="prefect_name"></span>\n\t\t\t               </div>\n\t\t\t            </div>\n\t            <div class="Col">\n\t               <div id="closetab" style="font-size: 10px; color: #aaa; text-align: right; line-height: 20px;">X</div>\n\t            </div>\n\t\t\t         </div>\n\t\t\t      </div>\n\t\t\t      <div class="Row">\n\t\t\t        <div class="LabeledDataFrame">\n\t\t\t           <h3>${LABELS[LANG].prefectures.danger}</h3>\n\t\t\t           <div class="content">\n\t\t\t              <div class="color"><span id="dangerlevel"></span></div>\n\t\t\t           </div>\n\t\t\t        </div>\n\t\t\t      </div>\n\t\t\t      <div class="Row">\n\t\t\t         <div class="LabeledDataFrame" style="width:100%">\n\t\t\t          <h3>${LABELS[LANG].prefectures.latest_cases}</h3>\n\t\t\t            <div class="content">\n\t\t\t               <canvas style="width: 100% !important;height: auto !important;" id="myChart">\n\t\t\t            </div>\n\t\t\t         </div>\n\t\t\t      </div>\n\t\t\t   </div>\n\t\t\t</div>`);const o=(t,e,a)=>{let i=new Date(t[0],t[1]-1,t[2]);i.setDate(i.getDate()+e);let o="",r=i.getFullYear(),s=i.getMonth()+1,n=i.getDate();if(a){o=1e4*parseInt(r)+100*parseInt(s)+parseInt(n)}else"gr"===LANG&&(o=s+"/"+n),"en"===LANG&&(o=s+"/"+n);return o};$(".personPopupTrigger").on("mouseover",function(){$(this).data("hoverIntentAttached")||($(this).data("hoverIntentAttached",!0),$(this).hoverIntent(function(){t&&clearTimeout(t);var e=$(this).attr("rel").split(","),r=e[0],s=e[1],n=e[2];if(""!=s){var d=$(this).offset(),l=$(this).width(),c={left:d.left+l+"px",top:d.top-5+"px"};if(a.left!=c.left||a.top!=c.top){i.css({left:c.left,top:c.top}),a=c,$("#prefect_name").html(r),$("#dangerlevel").html(s);var p={less25:"#0a8a20",less50:"#ffc300",less150:"#E5712A",less500:"#c82d2d",over500:"#800000",grey:"#605f69"};$(".color").removeAttr("style").css({color:p[n],"font-weight":"bold"}),$(".colorclass").removeAttr("style").css({"background-color":p[n]});var u,g,h=$("#myChart"),f=new Chart(h,{type:"bar",data:{labels:[],datasets:[{label:"",fill:!1,lineTension:.1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[],spanGaps:!1}]},options:{responsive:!0,legend:{display:!1},title:{display:!1},tooltips:{mode:"index",intersect:!1},scales:{yAxes:[{ticks:{beginAtZero:!0}}]},animation:{duration:500,easing:"easeOutQuart",onComplete:function(){var t=this.chart.ctx;t.font=Chart.helpers.fontString("10","bold",Chart.defaults.global.defaultFontFamily),t.textAlign="center",t.textBaseline="bottom",this.data.datasets.forEach(function(e){for(var a=0;a<e.data.length;a++){var i=e._meta[Object.keys(e._meta)[0]].data[a]._model,o=e._meta[Object.keys(e._meta)[0]].data[a]._yScale.maxHeight;t.fillStyle="#444";var r=i.y-5;(o-i.y)/o>=.85&&(r=i.y+20),t.fillText(e.data[a],i.x,r)}})}}}});i.css("display","block"),u=f,g=r,gData["prefectures-details"].forEach(function(t,e){t[LANG]==g&&(u.legend.display=!1,u.data.datasets[0].data=gData["prefectures-details"][e].carriers.values,gData["prefectures-details"][e].carriers.values.forEach(function(t,a){u.data.labels.push(o(gData["prefectures-details"][e].carriers.from,a,!1))}),u.update())})}}},e),$(this).trigger("mouseover"))}),$("body").append(i),$("#PopupContainer").mouseover(function(){t&&clearTimeout(t)}),$("#PopupContainer").mouseout(e),$("#closetab").mouseover(closetab)},h=e=>{let a=$("#region-chart").empty().html("<canvas></canvas>"),i=a.find("canvas")[0],o=$("#select-pref-type").val();void 0!==o||(o="carriers");let r={type:"horizontalBar",data:{labels:[],datasets:[{label:"",backgroundColor:[],data:[]}]},options:{aspectRatio:.4,animation:{duration:1e3},responsive:!0,legend:{display:!1},title:{display:!1},tooltips:{xPadding:24,yPadding:12,displayColors:!0,callbacks:{title:function(t){return gData["prefectures-data"].forEach(function(e,a){e.gr!==t[0].yLabel&&e.en!==t[0].yLabel||$("#select-prefecture").val()!==e.code&&f(e.code)}),t[0].yLabel},label:function(t,e){return t.xLabel+{gr:"",en:" cases"}[LANG]}}},scales:{xAxes:[{position:"top",gridLines:{color:"rgba(255,255,255,0.2)"},ticks:{suggestedMin:0,fontColor:"rgba(255,255,255,0.7)",callback:function(e,a,i){return t(e)}}}],yAxes:[{gridLines:{color:"rgba(255,255,255,0.1)"},ticks:{fontColor:"rgba(255,255,255,0.7)"}}]}}};a.outerWidth()>=400&&(r.options.aspectRatio=1.3),""!==e&&(r.options.animation.duration=0);let n=[];if(gData["prefectures-data"].forEach(function(t,e){n.push({name:gData["prefectures-data"][e][LANG],value:s(t[o].values,t.code),code:(e+1).toString()})}),n.sort((t,e)=>t.value<e.value?1:t.value>e.value?-1:0),n.forEach(function(t,a){r.data.labels.push(t.name),r.data.datasets[0].data.push(t.value),e==t.code?r.data.datasets[0].backgroundColor.push(COLORS.selected):r.data.datasets[0].backgroundColor.push((t=>{let e=$("#select-pref-type").val();void 0!==e||(e="carriers");let a="rgba(90, 90, 90, 0.6)",i=s(gData["prefectures-data"][parseInt(t.code)-1][e].values,t.code);return i>=1&&(a=COLORS.dark,0===gThresholds[e]&&(a=COLORS.default)),i>=gThresholds[e]&&gThresholds[e]>=1&&(a=COLORS.default),a})(t))}),void 0!==i){let t=i.getContext("2d");window.myChart=new Chart(t,r)}},f=t=>{$("#select-prefecture").val(t),$(".transition.prefecture").each(function(){$(this).attr("pref",t),$(this).find("h3").find("span").text(gData["prefectures-data"][parseInt(t)-1][LANG]),o($(this),$(this).attr("code"),$(this).attr("pref"),!0),r($(this))})},m=()=>{let t,e,a,o,r=$("#map-box"),s=[];function n(t,a){$.each(s,function(t,i){var o=e.getRegion(i.prefname);if(void 0!==o&&void 0!==i.prefval[a.value]){o.setFill("#"+i.prefval[a.value][1]),o.setTooltip(i.prefname+"<br><sup>*</sup>"+LABELS[LANG].total+i.prefval[a.value][2]+"<br>"+LABELS[LANG].daily_cases+i.prefval[a.value][3]);var r=new Date(i.prefval[a.value][0]).toDateString().split(" ").slice(1).join(" ").split(" ");r[0]=LABELS[LANG].months_pref[r[0]],$("#date_txt").text(r.join(" "))}})}if(gData.transition.mapepi.forEach(function(e,i){var r=[];r.prefname=gData.transition.mapepi[i].en,r.prefval=gData.transition.mapepi[i].percentage.values,(a=new Date(gData.transition.mapepi[i].percentage.from).toDateString().split(" ").slice(1))[0]=LABELS[LANG].months_pref[a[0]],a=a.join(" "),(o=new Date(gData.transition.mapepi[i].percentage.to).toDateString().split(" ").slice(1))[0]=LABELS[LANG].months_pref[o[0]],o=o.join(" "),r.start=gData.transition.mapepi[i].percentage.from,s.push(r),t=r.prefval.length}),0!=$("#mapsvg").length)$("#mapsvg").mapSvg({width:"100%",height:"100%",colors:{baseDefault:"#000000",background:"#242A3C",selected:0,hover:20,directory:"#fafafa",status:{}},viewBox:[0,-1.8823751724135036,6843.8384,6761.240350344827],tooltips:{mode:"id",on:!1,priority:"local",position:"bottom-right"},source:"/lib/mapsvg/maps/not-calibrated\\greece.svg",title:"Not-calibrated\\greece",responsive:!0,afterLoad:function(){e=this,$(".map").show(),$("#slider").slider({range:!1,min:0,max:t-1,step:1,slide:function(t,e){n(0,e)},change:function(t,e){n(0,e)},create:function(e,a){$(this).slider("value",t-1)}});var a,i=!1,r=$("#pause");r.on("click",function(){0==(i=!i)?(clearInterval(a),r.html("Play")):a=setInterval(function(){var t=$("#slider").slider("value"),e=parseInt(t)+1;$("#slider").slider("value",e),$("#sliderval").val(e),r.html("Pause")},200)}),$("#date_txt").text(o)}});i(r)};$.getJSON("https://raw.githubusercontent.com/Sandbird/covid19-Greece/master/greece.json?version="+RANDOMSTRING,function(o){gData=o,(()=>{const t=t=>{let e=t.sort((t,e)=>t-e),a=[Math.floor(t.length/2),Math.ceil(t.length/2)];return(e[a[0]]+e[a[1]])/2};for(thType in gThresholds){let e=[];gData["prefectures-data"].forEach(function(t,a){"carriers"!==t[thType]&&"deaths"!==t[thType]&&"vaccinations"!==t[thType]||e.push(s(t[thType].values),t.code)}),gThresholds[thType]=t(e)}})(),e(),(()=>{let t=$("#demography-box-group-cases"),e={navigation:{buttonOptions:{enabled:!1}},credits:{enabled:!1},chart:{type:"column"},title:{text:""},xAxis:{categories:[]},yAxis:{min:0,gridLineDashStyle:"shortdash",title:{text:"Κρούσματα"}},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.0f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0},plotOptions:{column:{pointPadding:.4,borderWidth:0,pointWidth:5}},series:[]};var a={};gData.demography_group_cases.categories.forEach(function(t,e){a[e]=n(t)}),e.xAxis.categories=a,gData.demography_group_cases.age_groups.forEach(function(t,a){t=(t=t.replace("Male",LABELS[LANG].male)).replace("Female",LABELS[LANG].female),e.series.push({name:t,data:gData.demography_group_cases.cases[a]})}),0!=$("#demography-chart-group-cases").length&&$("#demography-chart-group-cases").highcharts(e),i(t)})(),(()=>{let t=$("#demography-box-group-deaths"),e={navigation:{buttonOptions:{enabled:!1}},credits:{enabled:!1},chart:{type:"column"},title:{text:""},xAxis:{categories:[]},yAxis:{min:0,gridLineDashStyle:"shortdash",title:{text:"Θάνατοι"}},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.0f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0},plotOptions:{column:{pointPadding:.4,borderWidth:0,pointWidth:5}},series:[]};var a={};gData.demography_group_deaths.categories.forEach(function(t,e){a[e]=n(t)}),e.xAxis.categories=a,gData.demography_group_deaths.age_groups.forEach(function(t,a){t=(t=t.replace("Male",LABELS[LANG].male)).replace("Female",LABELS[LANG].female),e.series.push({name:t,data:gData.demography_group_deaths.deaths[a]})}),0!=$("#demography-chart-group-deaths").length&&$("#demography-chart-group-deaths").highcharts(e),i(t)})(),(()=>{let t=$("#demography-box-group-intensive"),e={navigation:{buttonOptions:{enabled:!1}},credits:{enabled:!1},chart:{type:"column"},title:{text:""},xAxis:{categories:[]},yAxis:{min:0,gridLineDashStyle:"shortdash",title:{text:"Νοσηλείες"}},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.0f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0},plotOptions:{column:{pointPadding:.4,borderWidth:0,pointWidth:5}},series:[]};var a={};gData.demography_group_intensive.categories.forEach(function(t,e){a[e]=n(t)}),e.xAxis.categories=a,gData.demography_group_intensive.age_groups.forEach(function(t,a){t=(t=t.replace("Male",LABELS[LANG].male)).replace("Female",LABELS[LANG].female),e.series.push({name:t,data:gData.demography_group_intensive.intensive[a]})}),0!=$("#demography-chart-group-intensive").length&&$("#demography-chart-group-intensive").highcharts(e),i(t)})(),c(),(()=>{$wrapper=$("#demography-chart").empty().html("<canvas></canvas>"),$canvas=$wrapper.find("canvas")[0];let e=$("#demography-box"),a={type:"horizontalBar",data:{labels:[],datasets:[{label:LABELS[LANG].demography.serious,backgroundColor:COLORS.serious,borderWidth:.5,borderColor:"#242a3c",data:[]},{label:LABELS[LANG].demography.deaths,backgroundColor:COLORS.deaths,borderWidth:.5,borderColor:"#242a3c",data:[]},{label:LABELS[LANG].demography.cases,backgroundColor:COLORS.default,borderWidth:.5,borderColor:"#242a3c",data:[]}]},options:{aspectRatio:.9,responsive:!0,legend:{display:!0,labels:{fontColor:"rgba(255, 255, 255, 0.7)"}},title:{display:!1},tooltips:{xPadding:24,yPadding:12,displayColors:!0,callbacks:{title:function(t){let e=t[0].yLabel,a=0;return t.forEach(function(t,e){a+=t.xLabel}),e+": "+a+" "+{gr:"",en:"cases"}[LANG]},label:function(t,e){var a="";return 1==t.datasetIndex&&(a=" ("+(e.datasets[t.datasetIndex].data[t.index]/e.datasets[2].data[t.index]*100).toFixed(1)+"%)"),e.datasets[t.datasetIndex].label+": "+t.value+a+{gr:"",en:" cases"}[LANG]}}},scales:{xAxes:[{stacked:!0,position:"top",gridLines:{color:"rgba(255,255,255,0.2)",zeroLineColor:"rgba(255,255,255,0.2)",borderDash:[3,1]},ticks:{suggestedMin:0,fontColor:"rgba(255,255,255,0.7)",callback:function(e,a,i){return t(e)}}}],yAxes:[{stacked:!0,barPercentage:.5,gridLines:{color:"rgba(255,255,255,0.1)"},ticks:{fontColor:"rgba(255,255,255,0.7)"}}]}}};if($wrapper.outerWidth()>=400&&(a.options.aspectRatio=2.1),$wrapper.outerWidth()>=600&&(a.options.aspectRatio=2.3),gData.demography_sum.forEach(function(t,e){a.data.labels.push(LABELS[LANG].age[e]);for(let e=0;e<3;e++)a.data.datasets[e].data.push(t[e])}),"undefined"!=typeof $canvas){let t=$canvas.getContext("2d");window.myChart=new Chart(t,a)}i(e)})(),(()=>{$wrapper=$("#demography-chart-men").empty().html("<canvas></canvas>"),$canvas=$wrapper.find("canvas")[0];let e=$("#demography-box-men"),a={type:"horizontalBar",data:{labels:[],datasets:[{label:LABELS[LANG].demography.serious,backgroundColor:COLORS.serious,borderWidth:.5,borderColor:"#242a3c",data:[]},{label:LABELS[LANG].demography.deaths,backgroundColor:COLORS.deaths,borderWidth:.5,borderColor:"#242a3c",data:[]},{label:LABELS[LANG].demography.cases,backgroundColor:COLORS.default,borderWidth:.5,borderColor:"#242a3c",data:[]}]},options:{aspectRatio:.9,responsive:!0,legend:{display:!0,labels:{fontColor:"rgba(255, 255, 255, 0.7)"}},title:{display:!1},tooltips:{xPadding:24,yPadding:12,displayColors:!0,callbacks:{title:function(t){let e=t[0].yLabel,a=0;return t.forEach(function(t,e){a+=t.xLabel}),e+": "+a+" "+{gr:"",en:"cases"}[LANG]},label:function(t,e){var a="";return 1==t.datasetIndex&&(a=" ("+(e.datasets[t.datasetIndex].data[t.index]/e.datasets[2].data[t.index]*100).toFixed(1)+"%)"),e.datasets[t.datasetIndex].label+": "+t.value+a+{gr:"",en:" cases"}[LANG]}}},scales:{xAxes:[{stacked:!0,position:"top",gridLines:{color:"rgba(255,255,255,0.2)",zeroLineColor:"rgba(255,255,255,0.2)",borderDash:[3,1]},ticks:{suggestedMin:0,fontColor:"rgba(255,255,255,0.7)",callback:function(e,a,i){return t(e)}}}],yAxes:[{stacked:!0,barPercentage:.5,gridLines:{color:"rgba(255,255,255,0.1)"},ticks:{fontColor:"rgba(255,255,255,0.7)"}}]}}};if($wrapper.outerWidth()>=400&&(a.options.aspectRatio=2.1),$wrapper.outerWidth()>=600&&(a.options.aspectRatio=2.3),gData.demography_men.forEach(function(t,e){a.data.labels.push(LABELS[LANG].age[e]);for(let e=0;e<3;e++)a.data.datasets[e].data.push(t[e])}),"undefined"!=typeof $canvas){let t=$canvas.getContext("2d");window.myChart=new Chart(t,a)}i(e)})(),(()=>{$wrapper=$("#demography-chart-women").empty().html("<canvas></canvas>"),$canvas=$wrapper.find("canvas")[0];let e=$("#demography-box-women"),a={type:"horizontalBar",data:{labels:[],datasets:[{label:LABELS[LANG].demography.serious,backgroundColor:COLORS.serious,borderWidth:.5,borderColor:"#242a3c",data:[]},{label:LABELS[LANG].demography.deaths,backgroundColor:COLORS.deaths,borderWidth:.5,borderColor:"#242a3c",data:[]},{label:LABELS[LANG].demography.cases,backgroundColor:COLORS.default,borderWidth:.5,borderColor:"#242a3c",data:[]}]},options:{aspectRatio:.9,responsive:!0,legend:{display:!0,labels:{fontColor:"rgba(255, 255, 255, 0.7)"}},title:{display:!1},tooltips:{xPadding:24,yPadding:12,displayColors:!0,callbacks:{title:function(t){let e=t[0].yLabel,a=0;return t.forEach(function(t,e){a+=t.xLabel}),e+": "+a+" "+{gr:"",en:"cases"}[LANG]},label:function(t,e){var a="";return 1==t.datasetIndex&&(a=" ("+(e.datasets[t.datasetIndex].data[t.index]/e.datasets[2].data[t.index]*100).toFixed(1)+"%)"),e.datasets[t.datasetIndex].label+": "+t.value+a+{gr:"",en:" cases"}[LANG]}}},scales:{xAxes:[{stacked:!0,position:"top",gridLines:{color:"rgba(255,255,255,0.2)",zeroLineColor:"rgba(255,255,255,0.2)",borderDash:[3,1]},ticks:{suggestedMin:0,fontColor:"rgba(255,255,255,0.7)",callback:function(e,a,i){return t(e)}}}],yAxes:[{stacked:!0,barPercentage:.5,gridLines:{color:"rgba(255,255,255,0.1)"},ticks:{fontColor:"rgba(255,255,255,0.7)"}}]}}};if($wrapper.outerWidth()>=400&&(a.options.aspectRatio=2.1),$wrapper.outerWidth()>=600&&(a.options.aspectRatio=2.3),gData.demography_women.forEach(function(t,e){a.data.labels.push(LABELS[LANG].age[e]);for(let e=0;e<3;e++)a.data.datasets[e].data.push(t[e])}),"undefined"!=typeof $canvas){let t=$canvas.getContext("2d");window.myChart=new Chart(t,a)}i(e)})(),l(),p(),h(""),f("1"),u(),$(".updated-last").text(gData.updated.last[LANG]),$(".updated-demography-cases").text(gData.updated.demography[LANG]),$(".updated-demography-deaths").text(gData.updated.demography[LANG]),$(".updated-demography-serious").text(gData.updated.demography[LANG]),$(".updated-demography-sum").text(gData.updated.demography[LANG]),$(".updated-demography-men").text(gData.updated.demography[LANG]),$(".updated-demography-women").text(gData.updated.demography[LANG]),$(".updated-unemployment").text(gData.updated.demography[LANG]),a();var r=$("#predicted_scroller").scrollLeft(),d=(new Date).getWeek();$("#predicted_scroller").animate({scrollLeft:r-4*d},800),$("#cover-block").fadeOut(),g(),m()}),$(".transition").find(".switch").on("click",function(){let t=$(this).closest(".transition");$(this).siblings(".switch").removeClass("selected"),$(this).addClass("selected"),o(t,t.attr("code"),t.attr("pref"),!0)}),$("#select-prefecture").on("change",function(){let t=$(this).val();f(t)}),$("#select-pref-type").on("change",function(){h("")}),$("#select-unemp-type").on("change",function(){c()}),$(".more").on("click",function(){$(this).closest("p.notes").addClass("show")}),$(".checkboxes").find(".checkbox").on("click",function(){$(this).hasClass("on")?$(this).removeClass("on"):$(this).addClass("on");let t=$(this).closest(".transition");o(t,t.attr("code"),t.attr("pref"),!1)}),$('a[href^="#"]').click(function(){let t=$(this).attr("href"),e=$(t).offset().top;return $("body,html").animate({scrollTop:e},400,"swing"),!1})};function isInt(t){return/^-?[0-9]+$/.test(t)}Date.prototype.getWeek=function(){var t=new Date(this.getFullYear(),0,1),e=(new Date(this.getFullYear(),this.getMonth(),this.getDate())-t+1)/864e5;return Math.ceil(e/7)},$(function(){function t(t){$(".embedwin").slideFadeToggle(function(){t.removeClass("selected")})}init(),$(function(){$(".embedbut").on("click",function(){return $(this).hasClass("selected")?t($(this)):($(this).addClass("selected"),$(".embedwin").slideFadeToggle()),!1}),$(".close").on("click",function(){return t($(".embedbut")),!1})}),$.fn.slideFadeToggle=function(t,e){return this.animate({opacity:"toggle",height:"toggle"},"fast",t,e)}});